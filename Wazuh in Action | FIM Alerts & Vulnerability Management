# Tutorial: Wazuh in Action | FIM Alerts & Vulnerability Management
We will learn how to use Wazuh to detect suspicious file changes and manage system vulnerabilities like a security analyst.

### Step 1: Configure File Integrity Monitoring (FIM)
Tell Wazuh which files or directories to watch on our Windows endpoint. This configuration is managed centrally from the Wazuh server.
  - Connect to your server via SSH.
  - Open shared agent configuration file using command: "sudo nano /var/ossec/etc/shared/default/agent.conf"
  - Add the monitoring rule.

    <agent_config os="Windows">
      <syscheck>
        <directories check_all="yes" realtime="yes">C:\Users\*YourUsername*\Desktop</directories>
      </syscheck>
    </agent_config>

  - Save the file (`Ctrl+X`, `Y`, `Enter`) and restart the Wazuh manager: "sudo systemctl restart wazuh-manager"
    
### Step 2: Analyze the FIM Alert
  - Navigate to the FIM dashboard: In Wazuh, go to Menu -> EndPoint Security -> File Integrity Monitoring.
  - Investigate the alert

### Step 3: Enable Vulnerability Detection
This powerful module scans your agents for software with known vulnerabilities (CVEs).
  - On your Server, open configuration file with command: "sudo nano /var/ossec/etc/internal_options.conf"
  - Ensure the module is active -> vulnerability-detection.disable_scan_manager=0 Enable / 1 Disabled
  - Open the main configuration file:
    "sudo nano /var/ossec/etc/ossec.conf"
-   **Add the configuration / Make sure this block exists and is enabled.
    
    <vulnerability-detection enabled="yes" interval="5m" run_on_start="yes">
      <provider name="canonical"/>
      <provider name="nvd"/>
    </vulnerability-detection>
  
  - Restart and Wait "sudo systemctl restart wazuh-manager"

### Step 4: Analyze and Remediate Vulnerabilities
Once the dashboard is populated, you can begin your analysis.
  - Go to "Menu -> Threat Intelligence -> Vulnerability Detection".
  - Identify Threats Find a specific CVE you want to fix
  - Patch the System

### Step 5: Handle Non-Remediable Alerts (Alert Tuning)
Sometimes a patch isn't available from the Linux distributor yet. We can "tune" Wazuh to ignore this alert temporarily.
  - On your Server, open the local rules file:
    "sudo nano /var/ossec/etc/rules/local_rules.xml"
  - Add a Silencing Rule -> tells Wazuh to ignore a specific CVE on a specific agent by setting level="0"

    <group name="vulnerability-detection,">
      <rule id="100002" level="0">
        <if_sid>23500</if_sid>
        <field name="agent.name">cwe000-agent</field>
        <field name="vulnerability.cve">^CVE-XXXX-XXXXX$</field>
        <description>Ignoring non-remediable CVE pending vendor patch.</description>
      </rule>
    </group>

  - Restart the manager "sudo systemctl restart wazuh-manager"

Congratulations! You have now learned how to use Wazuh for active defense, vulnerability management, and alert tuning.
